receivers:
  tracesimulationreceiver:
    ## @param global - object - required
    ## Global settings that apply to all traces generated by the receiver.
    global:
      ## @param interval - duration - optional
      ## Interval at which traces are generated, must be greater than 0.
      ## Default: 5s
      interval: 5s
    ## @param blueprint - object - required
    ## Blueprint that defines the structure of the traces to be simulated.
    blueprint:
      ## @param type - string - required
      ## Type of blueprint. 'service' defines services and spans under them.
      type: service
      ## @param service - object - required if type=service
      ## Configuration for services participating in the simulation.
      service:
        ## @param default - object - optional
        ## Default wait time and duration for spans if not specified individually.
        default:
          ## @param delay - object - optional
          ## Default wait time before starting a span
          delay:
            ## @param for - string - optional
            ## Default wait time in the format of either
            ## - duration (e.g., 1s, 2m), must be greater than or equal to 0.
            ## - float (e.g., 0.5 for 50% of the parent span duration), must be greater than or equal to 0 and cannot be set for root spans.
            for: 10ms
            ## @param as - string - optional
            ## Type of delay. Can be 'absolute' or 'relative'.
            as: absolute
          ## @param duration - duration - optional
          ## Default duration of the span, must be greater than 0.
          duration:
            ## @param for - string - optional
            ## Default duration in the format of either
            ## - duration (e.g., 1s, 2m), must be greater than 0.
            ## - float (e.g., 0.5 for 50% of the parent span duration), must be greater than 0 and cannot be set for root spans.
            for: "0.8"
            ## @param as - string - optional
            ## Type of duration. Can be 'absolute' or 'relative'.
            as: relative
        ## @param services - list of objects - required
        ## List of services, each representing a simulated application or system component.
        services:
          ## @param name - string - required
          ## Name of the service. This is a unique identifier for the service.
          - name: client
            ## @param resource - map of key/value pairs - optional
            ## Resource attributes associated with the service (e.g., OS, instance ID, region).
            resource:
              os: android
            ## @param spans - list of objects - required
            ## Spans performed by the service, each representing a root span unless parent is specified.
            spans:
              ## @param name - string - required
              ## Name of the span.
              - name: send_request
                ## @param ref - string - optional
                ## Unique identifier for the span (used for child/linked relationships and span links)
                ## Must match the regex `^[a-zA-Z0-9_-]+$`.
                ref: send_request
                ## @param delay - object - optional if default.delay is set
                ## Wait time before starting a span.
                delay:
                  ## @param for - string - optional if default.delay.for is set
                  ## Wait time in one of the following formats:
                  ## - Duration: e.g., 1s, 2m (must be greater than or equal to 0).
                  ## - Float: e.g., 0.5 (50% of the parent span duration, must be greater than or equal to 0 and cannot be set for root spans).
                  for: 0s
                  ## @param as - string - optional if default.delay.as is set
                  ## Type of delay. Can be one of:
                  ## - 'absolute': Specifies a fixed delay.
                  ## - 'relative': Specifies a delay relative to the parent span.
                  as: absolute
                ## @param duration - duration - optional if default.duration is set
                ## Default duration of the span, must be greater than 0.
                duration:
                  ## @param for - string - optional if default.duration.for is set
                  ## Default duration in one of the following formats:
                  ## - Absolute: duration (e.g., 1s, 2m), must be greater than 0.
                  ## - Relative: float (e.g., 0.5 for 50% of the parent span duration), must be greater than 0 and cannot be set for root spans.
                  ## Root spans must specify an absolute duration.
                  for: 1s
                  ## @param as - string - optional if default.duration.as is set
                  ## Type of duration. Can be one of:
                  ## - 'absolute': Specifies a fixed duration.
                  ## - 'relative': Specifies a duration relative to the parent span.
                  ## Root spans must specify an absolute duration.
                  as: absolute
                ## @param kind - string - optional
                ## Kind of the span. Can be 'client', 'server', 'producer', 'consumer', or 'internal'.
                kind: client
                ## @param attributes - map of key/value pairs - optional
                ## Attributes associated with the service (e.g., version, environment).
                attributes:
                  team: mobile
          - name: server
            resource:
              service.version: 1.1.0
            spans:
              - name: accept_request
                ## @param parent - string - optional
                ## The ref of the span that this span is a child of.
                ## You can use this to create a parent-child relationship between spans
                parent: send_request
                kind: server
                ## @param events - list of objects - optional
                ## List of events associated with the span.
                events:
                  ## @param name - string - required
                  ## Name of the event.
                  - name: request_received
                    ## @param delay - object - required
                    ## Wait time before starting the event.
                    delay:
                      ## @param for - string - required
                      ## Wait time in one of the following formats:
                      ## - Duration: e.g., 1s, 2m (must be greater than or equal to 0).
                      ## - Float: e.g., 0.5 (50% of the span duration, must be greater than or equal to 0).
                      for: 0s
                      ## @param as - string - required
                      ## Type of delay. Can be one of:
                      ## - 'absolute': Specifies a fixed delay.
                      ## - 'relative': Specifies a delay relative to the span it belongs to..
                      as: absolute
                      ## @param attributes - map of key/value pairs - optional
                      ## Attributes associated with the event (e.g., HTTP method, target).
                    attributes:
                      http.method: GET
                      http.target: /api/v1/resource
                ## @param children - list of objects (same as spans) - optional
                ## List of child spans that are executed after the parent span.
                children:
                  - name: produce_message_event
                    ref: produce_message_event
                    kind: producer
                    duration:
                      for: "0.3"
          - name: consumer
            spans:
              - name: consume_message_event
                duration:
                  for: 200ms
                  as: absolute
                kind: consumer
                ## @param links - list of strings - optional
                ## List of span refs that this span is linked to.
                links:
                  - produce_message_event
                children:
                  - name: process_message_event
                    kind: internal
                    ## @param conditional_effects - list of objects - optional
                    ## List of conditional effects that can be applied to the span.
                    conditional_effects:
                      ## @param condition - object - required
                      ## Condition that determines when the effects should be applied.
                      - condition:
                          ## @param type - string - required
                          ## Type of condition. Available types are the following:
                          ## - probabilistic: Applies effects based on a probability threshold.
                          ## - child_marked_as_failed: Applies effects if the child span of the span is marked as failed.
                          kind: probabilistic
                          ## @param probabilistic - object - required
                          ## Probabilistic condition that determines the probability of the effects being applied.
                          probabilistic:
                            ## @param threshold - float - required
                            ## Threshold for the condition. The effects will be applied if the random number is less than this threshold.
                            threshold: 0.1
                        ## @param effects - list of objects - required
                        ## List of effects to be applied if the condition is met.
                        effects:
                          ## @param kind - string - required
                          ## Type of effect. Can be 'mark_as_failed', 'annotate', or 'record_event'.
                          - kind: mark_as_failed
                            ## @param mark_as_failed - object - required
                            ## Effect that marks the span as failed, leading to a span with the status 'Error'.
                            mark_as_failed:
                              ## @param message - string - required
                              ## Message to be logged as `Status.message`.
                              message: "Failed to process message event"
                          - kind: annotate
                            ## @param annotate - object - required
                            ## Effect that adds an attribute to the span.
                            annotate:
                              ## @param attributes - map of key/value pairs - required
                              ## Attributes to be added to the span.
                              attributes:
                                error.type: "ProcessingError"
                          - kind: record_event
                            ## @param record_event - object - required
                            ## Effect that records an event in the span.
                            record_event:
                              ## @param event - object (same as the event in the span) - required
                              ## Event to be recorded in the span.
                              event:
                                name: exception
                                delay:
                                  for: "1.0"
                                  as: relative
                                attributes:
                                  exception.type: "ProcessingError"
                                  exception.message: "Failed to process message event"

exporters:
  debug:
    verbosity: detailed

service:
  pipelines:
    traces:
      receivers: [ tracesimulationreceiver ]
      processors: [ ]
      exporters: [ debug ]
